<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>2D Movement</title>
		<style>
			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
				font-family: "Source Sans Pro", "Open Sans", "Arial", "Helvetica", sans-serif;
				font-size: 13pt;
			}

			body {
				background: black;
				overflow: hidden;
				color: white;

				-webkit-transform: translateZ(0);
				-moz-transform: translateZ(0);
				-ms-transform: translateZ(0);
				-o-transform: translateZ(0);
				transform: translateZ(0);
			}

			canvas {
				cursor: crosshair;
				z-index: 0;
			}

			button {
				padding: 5pt 7pt;
				margin-left: 10pt;
				background: rgba(255, 255, 255, .9);
				color: black;
				border: none;
				cursor: pointer;
			}

			button:hover, button:focus {
				background: white;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas" tabindex="1"></canvas>
		<script>
			const DEBUG = location.search.includes("debug=true")
			const canvas = document.getElementById("canvas")

			window.addEventListener("resize", () => {
				canvas.width = window.innerWidth
				canvas.height = window.innerHeight 
			}, false)

			window.dispatchEvent(new Event("resize"))
		</script>
		<script>
			/**
			 * @param {Object} transform
			 * @param {Number} transform.x
			 * @param {Number} transform.y
			 * @param {Number} transform.a
			 * @param {Boolean} rotate
			 */
			CanvasRenderingContext2D.prototype.applyTransform = function applyTransform(transform, rotate = true) {
				this.translate(transform.x, transform.y)

				rotate && this.rotate(transform.a)
			}

			CanvasRenderingContext2D.prototype.resetTransform = function resetTransform() {
				this.setTransform(1, 0, 0, 1, 0, 0)
			}
		</script>
		<script src="app.js"></script>
		<script>
			if (DEBUG) {
				const pauseButton = document.createElement("button")

				pauseButton.textContent = "PLAY / PAUSE"
				
				pauseButton.style.position = "fixed"
				pauseButton.style.top = "0"
				pauseButton.style.right = "0"

				pauseButton.onclick = function onclick() {
					world.isRunning ? world.freeze() : world.run()
				}

				document.body.appendChild(pauseButton)
			}
		</script>
		<script>
			if (DEBUG) {
				const img = document.createElement("img")

				img.src = "transform-api.svg"
				img.style.width = "100%"
				img.style.height = "auto"

				const h1 = document.createElement("h1")

				h1.textContent = "API"
				h1.style.width = "100%"
				h1.style.fontFamily = "sans-serif"
				h1.style.textAlign = "center"
				h1.style.fontSize = "30px"

				const apiDocumentation = document.createElement("div")

				apiDocumentation.style.position = "fixed"
				apiDocumentation.style.top = "36px"
				apiDocumentation.style.right = "0"
				apiDocumentation.style.bottom = "0"
				apiDocumentation.style.maxWidth = "96px"
				apiDocumentation.style.overflowY = "auto"
				apiDocumentation.style.borderLeft = "1px dashed silver"

				apiDocumentation.onclick = function onclick() {
					apiDocumentation.style.maxWidth = apiDocumentation.style.maxWidth == "960px" ? "96px" : "960px"
				}

				apiDocumentation.appendChild(h1)
				apiDocumentation.appendChild(img)
				document.body.appendChild(apiDocumentation)
			}
		</script>
	</body>
</html>
